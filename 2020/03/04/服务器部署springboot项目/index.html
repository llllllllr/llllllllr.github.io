<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">

    

    

    <title>服务器部署springboot项目 | Hexo</title>
    <meta name="author" content="John Doe">
    <meta name="version" content="1.0.0">
    <meta name="keywords" content>
    <meta name="description" content="JDK主机： CentOS 7.6 64位  1.先下载jdk2.把jdk上传到服务器并安装1rpm -ivh jdk-8u231-linux-x64.rpm3.配置环境变量1vim /etc/profile4.令配置生效1source /etc/profile至此，java环境安装完成tomcat1.下载tomcat压缩文件夹到服务器2.解压1tar -zxvf xxxxxxxxxxxx.tar.zp3.此时要配置tomcat4.配置环境变量首先...">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">

    
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
    
    
    <link rel="icon" href="/images/notebook.ico">
    

    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

    <main class="app">
        <header class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">Hexo</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item" href="/">
                <span class="nav-text">首页</span>
            </a>
        
            <a class="nav-item" href="/categories/front-end">
                <span class="nav-text">Spring</span>
            </a>
        
            <a class="nav-item" href="/categories/linux">
                <span class="nav-text">Linux</span>
            </a>
        
            <a class="nav-item" href="/categories/java-basic">
                <span class="nav-text">java基础</span>
            </a>
        
            <a class="nav-item" href="/categories/alg">
                <span class="nav-text">每日一道算法</span>
            </a>
        
            <a class="nav-item" href="/tags">
                <span class="nav-text">标签</span>
            </a>
        
            <a class="nav-item" href="/archives">
                <span class="nav-text">归档</span>
            </a>
        
            <a class="nav-item" href="/atom.xml">
                <span class="nav-text">订阅</span>
            </a>
        
            <a class="nav-item" href="/about">
                <span class="nav-text">关于</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>

        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#JDK"><span class="toc-number">1.</span> <span class="toc-text">JDK</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tomcat"><span class="toc-number">2.</span> <span class="toc-text">tomcat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#maven"><span class="toc-number">3.</span> <span class="toc-text">maven</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git"><span class="toc-number">4.</span> <span class="toc-text">git</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#打jar包"><span class="toc-number">5.</span> <span class="toc-text">打jar包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#打war包"><span class="toc-number">6.</span> <span class="toc-text">打war包</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#错误记录"><span class="toc-number">6.1.</span> <span class="toc-text">错误记录</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-springboot-socket-打完war包启动项目的时候会出错："><span class="toc-number">6.1.1.</span> <span class="toc-text">1.springboot socket  打完war包启动项目的时候会出错：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-tomcat启动报错java-lang-NoClassDefFoundError-javax-el-ELManager"><span class="toc-number">6.2.</span> <span class="toc-text">2.tomcat启动报错java.lang.NoClassDefFoundError: javax/el/ELManager</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Tomcat启动报错：java-lang-NoClassDefFoundError-javax-servlet-GenericFilter"><span class="toc-number">6.3.</span> <span class="toc-text">4.Tomcat启动报错：java.lang.NoClassDefFoundError: javax/servlet/GenericFilter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-打war包过程出错-Insufficient-memory-for-Java-Runtime-Environment"><span class="toc-number">6.4.</span> <span class="toc-text">6.打war包过程出错 Insufficient memory for Java Runtime Environment</span></a></li></ol></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content"><article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            服务器部署springboot项目
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="http://yoursite.com/2020/03/04/服务器部署springboot项目/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2020-03-04T11:32:23.000Z" itemprop="datePublished">2020-03-04</time>
</a>

            

        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h3 id="JDK"><a href="#JDK" class="headerlink" title="JDK"></a>JDK</h3><blockquote>
<p>主机： CentOS 7.6 64位  </p>
</blockquote>
<p>1.先下载jdk</p>
<p>2.把jdk上传到服务器并安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh jdk-8u231-linux-x64.rpm</span><br></pre></td></tr></table></figure>

<p>3.配置环境变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure>

<p>4.令配置生效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<p>至此，java环境安装完成</p>
<h3 id="tomcat"><a href="#tomcat" class="headerlink" title="tomcat"></a>tomcat</h3><p>1.下载tomcat压缩文件夹到服务器</p>
<p>2.解压</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf xxxxxxxxxxxx.tar.zp</span><br></pre></td></tr></table></figure>

<p>3.此时要配置tomcat</p>
<p>4.配置环境变量</p>
<blockquote>
<p>首先配置SSL证书（域名已购买，备案，解析）</p>
<p>因为购买的是阿里云SSL，所以根据阿里云文档配置</p>
</blockquote>
<ul>
<li>根据文档指引进入tomcat安装目录下的conf目录，更改server.xml文件里面的配置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"443"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">SSLEnabled</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">scheme</span>=<span class="string">"https"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">secure</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">keystoreFile</span>=<span class="string">"Tomcat安装目录/cert/domain name.pfx"</span> #证书名称前需加上证书的绝对路径</span></span><br><span class="line"><span class="tag">    <span class="attr">keystoreType</span>=<span class="string">"PKCS12"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">keystorePass</span>=<span class="string">"证书密码"</span>   </span></span><br><span class="line"><span class="tag">    <span class="attr">clientAuth</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">SSLProtocol</span>=<span class="string">"TLSv1+TLSv1.1+TLSv1.2"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">ciphers</span>=<span class="string">"TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_256_CBC_SHA256"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">tips:记得更改8080端口为其它，并且设置服务器安全组，否则无法访问</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在这一步 tomcat无法shutdown，提示    SEVERE: Could not contact localhost:8005. Tomcat may not be running. 导致新配置的server.xml无法生效，所以 根据 <a href="https://www.cnblogs.com/Jomini/p/10788586.html" target="_blank" rel="noopener">https://www.cnblogs.com/Jomini/p/10788586.html</a>  修改</p>
</blockquote>
<h3 id="maven"><a href="#maven" class="headerlink" title="maven"></a>maven</h3><ul>
<li>下载maven tar包</li>
<li>解压到特定目录下</li>
<li>配置环境变量（记得 source /etc/profile)</li>
<li>输入 mvn -version看是否成功，如果不成功一般是环境变量的问题</li>
</ul>
<h3 id="git"><a href="#git" class="headerlink" title="git"></a>git</h3><blockquote>
<p> git安装依赖<br>sudo yum -y install zlib-devel openssl-devel cpio expat-devel gettext-devel curl-devel perl-ExtUtils-CBuilder perl-ExtUtils- MakeMaker </p>
</blockquote>
<ul>
<li>下载git tar.gz包</li>
<li>安装git 依赖</li>
<li>解压</li>
</ul>
<p>进入git安装目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">make prefix=usr/local/git all</span><br><span class="line">make prefix=/usr/local/git install</span><br><span class="line"></span><br><span class="line">git config --global user.name &quot;lllr&quot;</span><br><span class="line">git config --global user.email &quot;llllllllr12138@163.com&quot;</span><br><span class="line">git config --global core.autocrlf false//换行符不转换</span><br><span class="line">git config --global core.quotepath off //避免中文乱码</span><br><span class="line">git config --global gui.encoding utf-8//gui编码</span><br><span class="line">ssh-keygen -t rsa -C &quot;llllllllr12138@163.com&quot;</span><br><span class="line">ssh-add ~/.ssh/id_rsa </span><br><span class="line">eval `ssh-agent`//如果出现Could not open a connection to yourauthentication agent.然后再重新执行上面那条</span><br><span class="line">cat ~/.ssh/id_rsa.pub</span><br><span class="line">复制公钥</span><br><span class="line">在github添加公钥</span><br><span class="line">git clone 项目SSH</span><br></pre></td></tr></table></figure>

<h3 id="打jar包"><a href="#打jar包" class="headerlink" title="打jar包"></a>打jar包</h3><blockquote>
<p>(打完jar包回来发现，我需要打的是war包，因为需要在tomcat下运行，不过既然写完了，还是记录一下吧)</p>
<p>进入项目目录，在pom.xml加入下列代码，添加插件</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-dependency-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>$&#123;project.build.directory&#125;/libs<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">excludeTransitive</span>&gt;</span>false<span class="tag">&lt;/<span class="name">excludeTransitive</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">stripVersion</span>&gt;</span>false<span class="tag">&lt;/<span class="name">stripVersion</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">includeScope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">includeScope</span>&gt;</span></span><br><span class="line">                   <span class="comment">&lt;!--&lt;includeScope&gt;runtime&lt;/includeScope&gt;--&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">id</span>&gt;</span>copy-dependencies<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">goal</span>&gt;</span>copy-dependencies<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                           <span class="comment">&lt;!-- &lt;outputDirectory&gt;libs&lt;/outputDirectory&gt; --&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">excludeTransitive</span>&gt;</span>false<span class="tag">&lt;/<span class="name">excludeTransitive</span>&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">stripVersion</span>&gt;</span>true<span class="tag">&lt;/<span class="name">stripVersion</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">           <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package -Dmaven.test.skip=true//打jar包</span><br></pre></td></tr></table></figure>

<p>但是会报错<code>Project build error: Non-resolvable parent POM: Failure to transfer org.springframework.boot:spring-</code>，要在maven安装目录的setting.xml里面添加阿里云镜像仓库</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">#打包完后的jar名称，替换成你自己项目的名称，该名称可以在maven项目的pom中配置</span><br><span class="line">proc=&quot;breast-0.0.1-SNAPSHOT.jar&quot;</span><br><span class="line"> </span><br><span class="line">#启动类的包名+类名</span><br><span class="line">start_main_class=&quot;lllr.test.breast.BreastApplication&quot;</span><br><span class="line"> </span><br><span class="line">#项目源码的目录地址（初始可能需要自己从Git拉下来）</span><br><span class="line">SOURCE_HOME=&quot;/usr/java/developer/git-repository/breastfeed/server/bfbackend&quot;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">#JVM启动参数，关于JVM调优这里不介绍，感兴趣的可以自行百度 JVM调优</span><br><span class="line">JAVA_OPTS=&quot;-server -Xms2048M -Xmx2048M -Xss256k -Xmn768m -XX:SurvivorRatio=4 -XX:+AggressiveOpts -XX:+UseBiasedLocking -XX:MetaspaceSize=128M -XX:MaxMetaspaceSize=256M  -XX:CMSInitiatingOccupancyFraction=90 -XX:+CMSParallelRemarkEnabled -XX:+UseCMSCompactAtFullCollection -XX:+DisableExplicitGC -XX:MaxTenuringThreshold=0 -XX:CMSFullGCsBeforeCompaction=100 -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:LargePageSizeInBytes=128m -XX:+UseFastAccessorMethods -XX:+UseCMSInitiatingOccupancyOnly -Djava.awt.headless=true&quot;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">#编写启动方法</span><br><span class="line">start() &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cd git-repository/breastfeed/server/bfbackend/target</span><br><span class="line"> </span><br><span class="line">#输出，准备启动</span><br><span class="line">echo -n $&quot;Starting $proc:&quot;</span><br><span class="line"> </span><br><span class="line">#循环加载所需的jar，此处和2的pom配置有关</span><br><span class="line">for name in ./libs/*.jar</span><br><span class="line">do</span><br><span class="line">  APP_CLASS=&quot;$APP_CLASS:$name&quot;</span><br><span class="line">done</span><br><span class="line"> </span><br><span class="line">#启动脚本，--spring.profiles.active=   用于设置环境所使用的配置文件</span><br><span class="line">JAVA_CMD=&quot;java $JAVA_OPTS -classpath $CLASSPATH:$APP_CLASS:$proc $start_main_class&quot;</span><br><span class="line"> </span><br><span class="line">#后台运行</span><br><span class="line">echo &quot;$JAVA_CMD&quot;</span><br><span class="line"> </span><br><span class="line">#启动成功</span><br><span class="line">echo $&quot;start  ------------------------------------------------------------------------------------------------------------------------------------------------&quot;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">#停止方法，此处不用更改，是通过启动类名jar等检索出Java线程，kill</span><br><span class="line">stop() &#123;</span><br><span class="line">        echo -n $&quot;Stopping $proc:&quot;</span><br><span class="line">        aaa=$(ps aux | grep $proc |grep -v &quot;grep&quot; | awk &apos;&#123;print $2&#125;&apos;)</span><br><span class="line">        #aaa=$(ps -ef | grep  &quot;jar $proc&quot;  | awk &apos;&#123;print $2&#125;&apos;)</span><br><span class="line">	echo -n</span><br><span class="line">        if [ -z $aaa ]; then</span><br><span class="line">                echo &quot;can&apos;t find this process&quot;</span><br><span class="line">                exit 1</span><br><span class="line">        else</span><br><span class="line">                kill -9 $aaa</span><br><span class="line">	fi</span><br><span class="line">        </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">#设置脚本参数，启动的时候可以采用./脚本名称.sh start/stop/restart等参数</span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">  start)</span><br><span class="line">    start</span><br><span class="line">    ;;</span><br><span class="line">  stop)</span><br><span class="line">    stop</span><br><span class="line">    ;;</span><br><span class="line">  restart)</span><br><span class="line">    stop</span><br><span class="line">    start</span><br><span class="line">    ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>

<h3 id="打war包"><a href="#打war包" class="headerlink" title="打war包"></a>打war包</h3><p>war包需要修改：</p>
<p>1.添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.修改mainApplication</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainApplication</span> <span class="keyword">extends</span> <span class="title">SpringBootServletInitializer</span></span>&#123;</span><br><span class="line">	    <span class="meta">@Override</span></span><br><span class="line">	    <span class="function"><span class="keyword">protected</span> SpringApplicationBuilder <span class="title">configure</span><span class="params">(SpringApplicationBuilder builder)</span> </span>&#123;</span><br><span class="line">	        <span class="keyword">return</span> builder.sources(MainApplication.class);</span><br><span class="line">	    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.进入目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package -Dmaven.test.skip=true</span><br></pre></td></tr></table></figure>

<p>4.把war包放到tomcat webapps 目录下</p>
<h4 id="错误记录"><a href="#错误记录" class="headerlink" title="错误记录"></a>错误记录</h4><h5 id="1-springboot-socket-打完war包启动项目的时候会出错："><a href="#1-springboot-socket-打完war包启动项目的时候会出错：" class="headerlink" title="1.springboot socket  打完war包启动项目的时候会出错："></a>1.springboot socket  打完war包启动项目的时候会出错：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javax.websocket.DeploymentException: Multiple Endpoints may not be deployed to the p</span><br></pre></td></tr></table></figure>

<p><strong>解决</strong>：</p>
<p>注释掉以下代码( <a href="https://stackoverflow.com/questions/31178799/websocket-issue-multiple-endpoints-may-not-be-deployed-to-the-same-path" target="_blank" rel="noopener">https://stackoverflow.com/questions/31178799/websocket-issue-multiple-endpoints-may-not-be-deployed-to-the-same-path</a> )：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ServerEndpointExporter <span class="title">serverEndpointExporter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ServerEndpointExporter();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-tomcat启动报错java-lang-NoClassDefFoundError-javax-el-ELManager"><a href="#2-tomcat启动报错java-lang-NoClassDefFoundError-javax-el-ELManager" class="headerlink" title="2.tomcat启动报错java.lang.NoClassDefFoundError: javax/el/ELManager"></a>2.tomcat启动报错java.lang.NoClassDefFoundError: javax/el/ELManager</h4><p><strong>解决</strong>：</p>
<p>下载 javax.el.api.jar到tomcat lib目录下</p>
<h4 id="4-Tomcat启动报错：java-lang-NoClassDefFoundError-javax-servlet-GenericFilter"><a href="#4-Tomcat启动报错：java-lang-NoClassDefFoundError-javax-servlet-GenericFilter" class="headerlink" title="4.Tomcat启动报错：java.lang.NoClassDefFoundError: javax/servlet/GenericFilter"></a>4.Tomcat启动报错：java.lang.NoClassDefFoundError: javax/servlet/GenericFilter</h4><p><strong>解决</strong>：</p>
<p>pom.xml修改如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="6-打war包过程出错-Insufficient-memory-for-Java-Runtime-Environment"><a href="#6-打war包过程出错-Insufficient-memory-for-Java-Runtime-Environment" class="headerlink" title="6.打war包过程出错 Insufficient memory for Java Runtime Environment"></a>6.打war包过程出错 Insufficient memory for Java Runtime Environment</h4><p><strong>解决：</strong></p>
<p>云服务器内存不足，猜测是因为安装了其它各种软件，先关闭tomcat再重新打包</p>
<ol>
<li>进入tomcat安装目录</li>
<li>cd bin</li>
<li>输入<code>./shutdown.sh</code></li>
<li>重新打包</li>
</ol>

        
    </section>
</article>



<div class="comments">
    <div id="comments"></div>
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
    new Gitalk({
        clientID: "7fbe80427f54741e289f",
        clientSecret: "f34ed5fd92e54c9000bd37ba951948cb939deff5",
        repo: "sanonz.github.io",
        owner: "sanonz",
        admin: ["sanonz"],
        id: "2020/03/04/服务器部署springboot项目",
        distractionFreeMode: true,
        title: "服务器部署springboot项目",
        body: "http://yoursite.com/2020/03/04/服务器部署springboot项目/",
        labels: []
    }).render('comments');
    </script>
</div>

</div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>

    
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?e4027971a230b210f4671f485b33846a";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    
</footer>

    </main>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }
            
            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle();
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp();
            }, 3000);
        }
    });
    </script>
    
        <script type="text/javascript" src="/js/scrollspy.min.js"></script>
        <script type="text/javascript">
        $(document.body).scrollspy({target: '#aside-inner'});
        </script>
    

</body>
</html>
